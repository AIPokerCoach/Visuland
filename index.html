<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Immersive Spanish: Visulangâ€™s Mnemonic VR Experience</title>
    <meta name="description" content="Learn Spanish through playful mnemonics in a virtual world! Our innovative method uses vibrant image associations to make language learning fun and effective. Designed for all learners, including those with special needs, we ensure everyone can thrive in their Spanish language journey.">

    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <style>
        body { margin: 0; }
        a-scene { height: 100vh; }
    </style>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>

<script src="https://unpkg.com/aframe-physics-system@latest/dist/aframe-physics-system.min.js"></script>

    
</head>
<body>
    <a-scene physics="debug: true; gravity: -9.8">

        <a-assets>
            <!-- Load images -->
            <script>
                const images = [
                    "Aexplainer1", "Aexplainer2", "Aflag", "Aimage", "Airplane", "Almond", "Ankle", "Apple", "Apron", "Arm", "Art", "Baby", "Bag",
                    "Ball", "Balloon", "Bathroom", "Bear", "Bed", "Bee", "Belt", "Bench", "Bicycle", "Bimage",
                    "Bird", "Boat", "Bone", "Book", "Bottle", "Bowl", "Box", "Bracelet", "Brain",
                    "Bread", "Broom", "Bucket", "Cake", "Candy", "Car", "Carrot", "Castle", "Cat",
                    "Chair", "Cheese", "Cherry", "Chicken", "Chocolate", "Cimage", "Clock", "Coffee", "Coin",
                    "Cold", "Cookie", "Couch", "Cow", "Dimage", "Doctor", "Dog", "Doll", "Door", "Dress",
                    "Duck", "Earring", "Eexplainer1", "Eexplainer2", "Eflag", "Egg", "Eight", "Eimage", "Eye", "Face", "Farm", "Fimage", "Finger", "Fire",
                    "Fish", "Five", "Flour", "Flower", "Fork", "Four", "Fruit", "Garlic", "Gimage", "Glass",
                    "Glove", "Grape", "Green", "Hand", "Hat", "Head", "Health", "Heart", "Heavy",
                    "Help", "Himage", "History", "Hook", "Horse", "Hose", "Hospital", "Hot", "House", 
                    "Husband", "Iexplainer1", "Iexplainer2", "Iflag", "Iimage", "Jimage", "Jug", "Key", "Kimage", "Kite", "Knife", "Large", "Left", "Leg", "Lemon",
                    "Lentil", "Limage", "Lion", "Long", "Luggage", "Man", "Mattress", "Milk", "Mimage", "Mirror",
                    "Money", "Monkey", "Month", "Morning", "Mouse", "Mouth", "Mushroom", "Name",
                    "Nest", "Nimage", "Nine", "North", "Nose", "Oat", "Oexplainer1", "Oexplainer2", "Office", "Oflag", "Oil", "Oimage", "One", "Onion",
                    "Oven", "Owl", "Oxygen", "Pants", "Pear", "Pen", "Pencil", "Pepper", "Pig", "Pimage",
                    "Pink", "Plum", "Pool", "Popcorn", "Purple", "Qimage", "Rabbit", "Rag", "Red", "Rice", "Rimage",
                    "Salt", "Sandal", "Scissors", "Scooter", "Seven", "Shampoo", "Sheep", "Shirt",
                    "Shoe", "Short", "Shovel", "Simage", "Sister", "Six", "Skin", "Small", "Smile", "Snake",
                    "Sock", "Soup", "South", "Spinach", "Spoon", "Strawberry", "Study", "Table",
                    "Taco", "Tea", "Teacher", "Ten", "Three", "Timage", "Toaster", "Tomato", "Tree", 
                    "Triangle", "Truck", "Two", "Uimage", "Vimage", "Wallet", "Want", "Water", "Watermelon", "Wheel", 
                    "White", "Wimage", "Window", "Ximage", "Yellow", "Yimage", "Zexplainer1", "Zexplainer2", "Zflag", "Zimage"
                ];
           
                images.forEach((img) => {
                    const imgPath = `images/${img}.png`;
                    const imgElement = document.createElement('img');
                    imgElement.setAttribute('id', img.toLowerCase());
                    imgElement.setAttribute('src', imgPath);
                    document.body.appendChild(imgElement);
                });

                const azulejosElement = document.createElement('img');
            azulejosElement.setAttribute('id', 'azulejos');
            azulejosElement.setAttribute('src', 'textures/Azulejos.png'); // Updated path
            document.body.appendChild(azulejosElement);
                
</script>
    
        </a-assets>

        <!-- Sky with your texture -->
        <a-sky src="textures/test3605.jpg"></a-sky>

       <!-- Enhanced Camera with Mobile Controls -->
<a-entity id="cameraRig" position="-5 1.4 20" dynamic-body>
    <!-- Camera entity with look-controls and virtual joystick -->
    <a-camera look-controls collision-check>
        <!-- Virtual joystick for movement on mobile -->
        <a-entity id="left-hand" joystick="hand: left; mode: touch"></a-entity>
        <a-entity id="right-hand" joystick="hand: right; mode: touch"></a-entity>
        <a-cursor color="#FF0000"></a-cursor>
    </a-camera>
</a-entity>

<script>
    // Ensure the script runs after the scene and elements have fully loaded
    window.addEventListener('DOMContentLoaded', () => {
        const cameraRig = document.getElementById('cameraRig');
        const bounds = {
            xMin: -62.5 + 1.5, // account for the width of the walls
            xMax: 62.5 - 1.5,
            zMin: -62.5 + 1.5,
            zMax: 62.5 - 1.5,
        };

        // Listen for the wheel event to detect scroll
        window.addEventListener('wheel', function(event) {
            const scrollSpeed = 0.5; // Adjust this value to control scroll sensitivity

            const direction = new THREE.Vector3();
            cameraRig.object3D.getWorldDirection(direction);

            const delta = event.deltaY > 0 ? -scrollSpeed : scrollSpeed;

            const newPosition = cameraRig.object3D.position.clone().add(direction.multiplyScalar(delta));

            // Clamp the position to stay within bounds
            newPosition.x = Math.max(bounds.xMin, Math.min(newPosition.x, bounds.xMax));
            newPosition.z = Math.max(bounds.zMin, Math.min(newPosition.z, bounds.zMax));

            cameraRig.object3D.position.set(newPosition.x, newPosition.y, newPosition.z);
        });
    });
</script>


        <!-- Floor with Azulejos -->
    <a-plane position="0 0 0" rotation="-90 0 0" width="125" height="125" src="#azulejos" repeat="10 10"></a-plane>
        
        <!-- Exterior Walls -->
        <a-box position="-62.5 3 0" width="0.16" height="6" depth="125" color="#F1BF00" static-body></a-box>  <!-- Left Wall -->
        <a-box position="62.5 3 0" width="0.16" height="6" depth="125" color="#F1BF00" static-body></a-box>   <!-- Right Wall -->
        <a-box position="0 3 -62.5" width="125" height="6" depth="0.16" color="#F1BF00" static-body></a-box>  <!-- Back Wall -->
        <a-box position="0 3 62.5" width="125" height="6" depth="0.16" color="#F1BF00" static-body></a-box>   <!-- Front Wall -->

        <!-- Cubes -->
        <script>
            const spacing = 7.2; // Spacing between cubes
            const rows = 15; // Rows
            const cols = 15; // Columns
            
            for (let i = 0; i < images.length; i++) {
                const x = (i % cols) * spacing - (cols * spacing) / 2 + spacing / 2;
                const z = Math.floor(i / cols) * spacing - (rows * spacing) / 2 + spacing / 2;
                const imgId = images[i].toLowerCase();

                // Create a cube for each image
                const cube = document.createElement('a-box');
                cube.setAttribute('src', `#${imgId}`);
                cube.setAttribute('position', `${x} 1.5 ${z}`);
                cube.setAttribute('width', '3'); // Cube size
                cube.setAttribute('height', '3'); // Cube size
                cube.setAttribute('depth', '3'); // Cube size
                cube.setAttribute('collision-check', ''); // Add collision-check component
                cube.setAttribute('dynamic-body', ''); // Add dynamic-body component
                cube.addEventListener('collide', function (e) {
    console.log('Cube collided with', e.detail.body.el);
});
                document.querySelector('a-scene').appendChild(cube);
            }
        </script>
        <script>
  AFRAME.registerComponent('collision-check', {
    init: function () {
      this.raycaster = new THREE.Raycaster();
      this.cameraEl = this.el.querySelector('[camera]');
    },
    tick: function () {
      const cameraPos = new THREE.Vector3();
      this.cameraEl.object3D.getWorldPosition(cameraPos);

      const direction = new THREE.Vector3();
      this.cameraEl.object3D.getWorldDirection(direction);

      this.raycaster.set(cameraPos, direction);
      const intersects = this.raycaster.intersectObjects(this.el.sceneEl.children, true);

      if (intersects.length > 0) {
        // Step back if intersecting
        this.cameraEl.object3D.position.add(direction.multiplyScalar(-0.1));
      }
    }
  });
</script>

    </a-scene>
</body>
</html>
